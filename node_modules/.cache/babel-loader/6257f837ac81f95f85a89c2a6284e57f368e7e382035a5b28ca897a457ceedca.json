{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\madko\\\\Downloads\\\\Keycloack_login\\\\payco-auth\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children\n}) => {\n  _s();\n  const {\n    keycloak,\n    initialized\n  } = useKeycloak();\n  const token = localStorage.getItem(\"token\") || sessionStorage.getItem(\"token\");\n  console.log(\"ðŸŸ¡ Keycloak Initialized:\", initialized);\n  console.log(\"ðŸŸ¡ Keycloak Authenticated:\", keycloak.authenticated);\n  console.log(\"ðŸŸ¡ Token Found:\", token);\n  if (!initialized) {\n    console.log(\"ðŸŸ¡ Waiting for Keycloak to initialize...\");\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading Keycloak...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 11,\n      columnNumber: 12\n    }, this);\n  }\n\n  // âœ… If Keycloak is not authenticated but a token exists, try refreshing it\n  if (!keycloak.authenticated && token) {\n    console.log(\"ðŸŸ¡ Token exists but Keycloak is not authenticated. Trying refresh...\");\n    keycloak.updateToken(30).then(() => {\n      console.log(\"âœ… Keycloak session refreshed!\");\n      window.location.reload();\n    }).catch(error => {\n      console.error(\"ðŸ”´ Failed to refresh Keycloak session:\", error);\n      console.log(\"ðŸ”´ Keeping the user logged in but requiring re-authentication later.\");\n    });\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Refreshing session...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 29,\n      columnNumber: 12\n    }, this);\n  }\n\n  // âœ… If still not authenticated and no token, redirect to login\n  if (!keycloak.authenticated && !token) {\n    console.log(\"ðŸ”´ No token found. Redirecting to login...\");\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 35,\n      columnNumber: 12\n    }, this);\n  }\n  console.log(\"âœ… User is authenticated. Showing dashboard.\");\n  return children;\n};\n_s(ProtectedRoute, \"OgqNqA9n/+FM7bDQd9Rvz2CUjoM=\", true);\n_c = ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["ProtectedRoute","children","_s","keycloak","initialized","useKeycloak","token","localStorage","getItem","sessionStorage","console","log","authenticated","_jsxDEV","fileName","_jsxFileName","lineNumber","columnNumber","updateToken","then","window","location","reload","catch","error","Navigate","to","_c","$RefreshReg$"],"sources":["C:/Users/madko/Downloads/Keycloack_login/payco-auth/src/App.js"],"sourcesContent":["const ProtectedRoute = ({ children }) => {\n  const { keycloak, initialized } = useKeycloak();\n  const token = localStorage.getItem(\"token\") || sessionStorage.getItem(\"token\");\n\n  console.log(\"ðŸŸ¡ Keycloak Initialized:\", initialized);\n  console.log(\"ðŸŸ¡ Keycloak Authenticated:\", keycloak.authenticated);\n  console.log(\"ðŸŸ¡ Token Found:\", token);\n\n  if (!initialized) {\n    console.log(\"ðŸŸ¡ Waiting for Keycloak to initialize...\");\n    return <div>Loading Keycloak...</div>;\n  }\n\n  // âœ… If Keycloak is not authenticated but a token exists, try refreshing it\n  if (!keycloak.authenticated && token) {\n    console.log(\"ðŸŸ¡ Token exists but Keycloak is not authenticated. Trying refresh...\");\n    \n    keycloak\n      .updateToken(30)\n      .then(() => {\n        console.log(\"âœ… Keycloak session refreshed!\");\n        window.location.reload();\n      })\n      .catch((error) => {\n        console.error(\"ðŸ”´ Failed to refresh Keycloak session:\", error);\n        console.log(\"ðŸ”´ Keeping the user logged in but requiring re-authentication later.\");\n      });\n\n    return <div>Refreshing session...</div>;\n  }\n\n  // âœ… If still not authenticated and no token, redirect to login\n  if (!keycloak.authenticated && !token) {\n    console.log(\"ðŸ”´ No token found. Redirecting to login...\");\n    return <Navigate to=\"/login\" />;\n  }\n\n  console.log(\"âœ… User is authenticated. Showing dashboard.\");\n  return children;\n};\n"],"mappings":";;;AAAA,MAAMA,cAAc,GAAGA,CAAC;EAAEC;AAAS,CAAC,KAAK;EAAAC,EAAA;EACvC,MAAM;IAAEC,QAAQ;IAAEC;EAAY,CAAC,GAAGC,WAAW,CAAC,CAAC;EAC/C,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,IAAIC,cAAc,CAACD,OAAO,CAAC,OAAO,CAAC;EAE9EE,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEP,WAAW,CAAC;EACpDM,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAER,QAAQ,CAACS,aAAa,CAAC;EACjEF,OAAO,CAACC,GAAG,CAAC,iBAAiB,EAAEL,KAAK,CAAC;EAErC,IAAI,CAACF,WAAW,EAAE;IAChBM,OAAO,CAACC,GAAG,CAAC,0CAA0C,CAAC;IACvD,oBAAOE,OAAA;MAAAZ,QAAA,EAAK;IAAmB;MAAAa,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EACvC;;EAEA;EACA,IAAI,CAACd,QAAQ,CAACS,aAAa,IAAIN,KAAK,EAAE;IACpCI,OAAO,CAACC,GAAG,CAAC,sEAAsE,CAAC;IAEnFR,QAAQ,CACLe,WAAW,CAAC,EAAE,CAAC,CACfC,IAAI,CAAC,MAAM;MACVT,OAAO,CAACC,GAAG,CAAC,+BAA+B,CAAC;MAC5CS,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC;IAC1B,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,IAAK;MAChBd,OAAO,CAACc,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;MAC9Dd,OAAO,CAACC,GAAG,CAAC,sEAAsE,CAAC;IACrF,CAAC,CAAC;IAEJ,oBAAOE,OAAA;MAAAZ,QAAA,EAAK;IAAqB;MAAAa,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAK,CAAC;EACzC;;EAEA;EACA,IAAI,CAACd,QAAQ,CAACS,aAAa,IAAI,CAACN,KAAK,EAAE;IACrCI,OAAO,CAACC,GAAG,CAAC,4CAA4C,CAAC;IACzD,oBAAOE,OAAA,CAACY,QAAQ;MAACC,EAAE,EAAC;IAAQ;MAAAZ,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACjC;EAEAP,OAAO,CAACC,GAAG,CAAC,6CAA6C,CAAC;EAC1D,OAAOV,QAAQ;AACjB,CAAC;AAACC,EAAA,CAvCIF,cAAc;AAAA2B,EAAA,GAAd3B,cAAc;AAAA,IAAA2B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}